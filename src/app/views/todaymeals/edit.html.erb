<% provide(:title, "食事編集") %>
<% provide(:btn_text, "編集") %>

<script src="https://cdn.jsdelivr.net/npm/chart.js@3.0.0/dist/chart.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>

<%= link_to(edit_user_myfood_path(@user, @myfood, recipe_id: params[:recipe_id], timezone_id: params[:timezone_id], start_time: params[:start_time], start_date: params[:start_date])) do %>
<div class="box1">
  <div class="row">
    <div class="col-md-12">
      <table class="table table-striped">
        <thead>
          <tr>
            <th><%= Myfood.human_attribute_name(:food_name) %></th>
            <% @attribute_names.each do |attribute_name| %>
              <th><%= attribute_name %></th>
            <% end %>
          </tr>
        </thead>
        <tbody>
          <tr>
            <th><%= @myfood.food_name %></th>
            <td><%= @myfood.calorie %></td>
            <td><%= @myfood.protein %></td>
            <td><%= @myfood.fat %></td>
            <td><%= @myfood.carbo %></td>
            <td><%= @myfood.sugar %></td>
            <td><%= @myfood.dietary_fiber %></td>
            <td><%= @myfood.salt %></td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
<% end %>

<div class="box1">
  <div class="row">
    <div class="col-md-12">
      <canvas id="myPieChart"></canvas>
      <script>myfood_graph();</script>
    </div>
  </div>
</div>

<div class="box1">
  <div class="row">
    <div class="mx-auto">
    </div>
    <div class="col-12">
      <%= form_with(model: @todaymeal, url: user_todaymeal_path(@user, @todaymeal, myfood_id: params[:myfood_id], timezone_id: params[:timezone_id], start_date: params[:start_date], start_time: params[:start_time]), method: :patch, local: true) do |f| %>
        <%= render partial: "form", locals: { f: f } %>
      <% end %>
  </div>
</div>