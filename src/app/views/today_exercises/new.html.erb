<div class="box1 center">
  運動登録
</div>

<div class="box1">
  <%= button_tag '登録', class: "btn btn-primary w-100px", form: "today_exercise-btn" %>
  <!--
  <= link_to '一覧へ戻る', exercise_categories_path, class: "btn btn-secondary" %>
  -->
</div>


<div class="box1">
  <%= form_with(model: @today_exercise, url: user_today_exercises_path(
    @current_user, start_date: params[:start_date], start_time: params[:start_time]), method: :post, local: true) do |f| %>

      <%= f.hidden_field :start_time, value: params[:start_time] %>

    <div>
      <%= f.label 'カテゴリー', class: "label-form" %>
      <%= f.select :exercise_category_id, options_from_collection_for_select(@categories, :id, :name),
                                          { prompt: true },
                                          { class: "form-control" }
      %>
    </div>

    <div>
      <%= f.label 'コンテンツ', class: "label-form" %>
      <%= f.select :exercise_content_id, options_from_collection_for_select(@contents, :id, :content),
                                        { include_blank: "カテゴリーを選択してください" },
                                        { class: "form-control" }
      %>
    </div>

    <div>
      <div>
        <%= f.label :exercise_time, class: "label-form" %>
      </div>
      <%= f.time_select :exercise_time, { start_hour: 0, end_hour: 12, minute_step: 15 },
                                        { class: "form-control", style: 'display: inline-block; width: auto;' }
      %>
    </div>

    <div>
      <%= f.label :note, class: "label-form" %>
      <%= f.text_field :note, class: "form-control" %>
    </div>

    <div>
      <%= f.submit "更新", class: "btn btn-lg btn-original btn-form" %>
    </div>
  <% end %>
</div>

<script>
$(function() {
    $('#today_exercise_exercise_category_id').change(function() {
      $.get({
        url: "<%= new_contents_user_today_exercises_path(current_user, start_date: params[:start_date], start_time: params[:start_time]) %>",
        data: { exercise_category_id: $('#today_exercise_exercise_category_id').has('option:selected').val() }
      });
    });
  });
</script>
