<% provide(:title, "#{@recipe.recipe_name}の食事登録") %>
<% provide(:btn_text, "記録") %>

<div class="box1">
  <div class="row">
    <div class="col-md-1 offset-md-11 align-self-center">
      <%= link_to(user_myfoods_path(current_user, recipe_id: params[:recipe_id], timezone_id: params[:timezone_id], start_time: params[:start_time], start_date: params[:start_date]), class: "text-original") do %>
        <i class="far fa-plus-square fa-2x"></i>
      <% end %>
    </div>
  </div>
</div>

<div class="box1">
  <div class="row">
    <div class="col-md-12">
      <table class="table table-striped sample">
        <thead>
          <tr>
            <th><%= Myfood.human_attribute_name(:food_name) %></th>
            <th><%= Myfood.human_attribute_name(:calorie) %></th>
            <th><%= Myfood.human_attribute_name(:protein) %></th>
            <th><%= Myfood.human_attribute_name(:fat) %></th>
            <th><%= Myfood.human_attribute_name(:carbo) %></th>
          </tr>
        </thead>
        <tbody>
          <% @recipefoods.each do |recipefood| %>
          <% @myfood = @user.myfoods.find(recipefood.id) %>
            <tr data-href=<%= user_myfood_path(@user, @myfood, timezone_id: params[:timezone_id], start_time: params[:start_time], start_date: params[:start_date]) %>>
              <td><%= @myfood.food_name %></td>
              <td><%= @myfood.calorie %></td>
              <td><%= @myfood.protein %></td>
              <td><%= @myfood.fat %></td>
              <td><%= @myfood.carbo %></td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
    <div class="col-12">
      <%= form_with(model: @todaymeal, url: user_todaymeals_path(@user, recipe_id: params[:recipe_id], myfood_id: params[:myfood_id], timezone_id: params[:timezone_id], start_date: params[:start_date], start_time: params[:start_time]), method: :post, local: true) do |f| %>
        <%= f.text_area :note, class: "form-control" %><br>
        
        <%= f.hidden_field :start_time, value: params[:start_time] %>
        <%= f.hidden_field :recipe_id, value: params[:recipe_id] %>
        <%= f.hidden_field :timezone_id, value: params[:timezone_id] %>
    </div>
    <div class="mx-auto">
        <%= f.submit yield(:btn_text), class: "btn btn-lg btn-original btn-form btn-setup" %>
        <%= link_to "戻る", user_recipes_path(timezone_id: params[:timezone_id], start_date: params[:start_date], start_time: params[:start_time]), class: "btn btn-lg btn-default btn-form" %>
    </div>
      <% end %>
  </div>
</div>

